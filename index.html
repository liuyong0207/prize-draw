<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>越秀星月队抽奖系统</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Microsoft YaHei', sans-serif;
        }
        body {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .container {
            width: 100%;
            max-width: 900px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }
        header {
            text-align: center;
            margin-bottom: 30px;
        }
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        .prize-buttons {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 30px;
        }
        .prize-btn {
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .prize-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 10px rgba(0, 0, 0, 0.3);
        }
        .prize-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        .prize-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .prize-icon {
            font-size: 1.5rem;
        }
        .prize-text {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
        .prize-name {
            font-size: 1.2rem;
        }
        .prize-item {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        .prize-count {
            background: rgba(0, 0, 0, 0.2);
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.9rem;
        }
        .first-prize {
            background: linear-gradient(to right, #ffce54, #ffa647);
            color: #333;
        }
        .second-prize {
            background: linear-gradient(to right, #4ecdc4, #556270);
            color: white;
        }
        .third-prize {
            background: linear-gradient(to right, #ff6b6b, #c44d58);
            color: white;
        }
        .consolation-prize {
            background: linear-gradient(to right, #acb6e5, #86fde8);
            color: #333;
        }
        .result-area {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            min-height: 150px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            font-size: 1.8rem;
            font-weight: bold;
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.2);
        }
        .rolling-text {
            font-size: 2.2rem;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .prize-desc {
            font-size: 1.2rem;
            margin-top: 10px;
            color: #ffce54;
        }
        .winners-list {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
        }
        .winners-list h2 {
            text-align: center;
            margin-bottom: 15px;
            font-size: 1.5rem;
        }
        .winner-category {
            margin-bottom: 15px;
        }
        .winner-category h3 {
            margin-bottom: 8px;
            color: #ffce54;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .winner-names {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        .winner-tag {
            background: rgba(255, 255, 255, 0.2);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .winner-icon {
            font-size: 1.1rem;
        }
        .rolling {
            animation: rollingAnimation 0.1s infinite;
        }
        @keyframes rollingAnimation {
            0% { opacity: 0.5; transform: translateY(5px); }
            100% { opacity: 1; transform: translateY(-5px); }
        }
        .footer {
            margin-top: 20px;
            text-align: center;
            font-size: 0.9rem;
            opacity: 0.8;
        }
        @media (max-width: 600px) {
            h1 {
                font-size: 2rem;
            }
            .result-area {
                font-size: 1.4rem;
            }
            .rolling-text {
                font-size: 1.8rem;
            }
            .prize-btn {
                padding: 12px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>🏆 幸运抽奖系统 🏆</h1>
            <p>点击按钮开始抽奖，再次点击停止并显示结果</p>
        </header>
        
        <div class="prize-buttons">
            <button class="prize-btn consolation-prize" onclick="startDrawing('consolation')">
                <div class="prize-info">
                    <span class="prize-icon">🎁</span>
                    <div class="prize-text">
                        <span class="prize-name">安慰奖</span>
                        <span class="prize-item">水壶</span>
                    </div>
                </div>
                <span class="prize-count">剩余: <span id="consolation-count">10</span></span>
            </button>
            
            <button class="prize-btn third-prize" onclick="startDrawing('third')">
                <div class="prize-info">
                    <span class="prize-icon">🥉</span>
                    <div class="prize-text">
                        <span class="prize-name">三等奖</span>
                        <span class="prize-item">眼镜</span>
                    </div>
                </div>
                <span class="prize-count">剩余: <span id="third-count">3</span></span>
            </button>
            
            <button class="prize-btn second-prize" onclick="startDrawing('second')">
                <div class="prize-info">
                    <span class="prize-icon">🥈</span>
                    <div class="prize-text">
                        <span class="prize-name">二等奖</span>
                        <span class="prize-item">前灯</span>
                    </div>
                </div>
                <span class="prize-count">剩余: <span id="second-count">2</span></span>
            </button>
            
            <button class="prize-btn first-prize" onclick="startDrawing('first')">
                <div class="prize-info">
                    <span class="prize-icon">🥇</span>
                    <div class="prize-text">
                        <span class="prize-name">一等奖</span>
                        <span class="prize-item">头盔</span>
                    </div>
                </div>
                <span class="prize-count">剩余: <span id="first-count">1</span></span>
            </button>
        </div>
        
        <div class="result-area">
            <div class="rolling-text" id="resultText">请点击上方按钮开始抽奖</div>
            <div class="prize-desc" id="prizeDesc"></div>
        </div>
        
        <div class="winners-list">
            <h2>🎯 中奖名单 🎯</h2>
            <div class="winner-category">
                <h3><span class="winner-icon">🥇</span> 一等奖 (头盔) - 1名</h3>
                <div class="winner-names" id="firstPrizeWinners"></div>
            </div>
            <div class="winner-category">
                <h3><span class="winner-icon">🥈</span> 二等奖 (前灯) - 2名</h3>
                <div class="winner-names" id="secondPrizeWinners"></div>
            </div>
            <div class="winner-category">
                <h3><span class="winner-icon">🥉</span> 三等奖 (眼镜) - 3名</h3>
                <div class="winner-names" id="thirdPrizeWinners"></div>
            </div>
            <div class="winner-category">
                <h3><span class="winner-icon">🎁</span> 安慰奖 (水壶) - 10名</h3>
                <div class="winner-names" id="consolationPrizeWinners"></div>
            </div>
        </div>
    </div>
    
    <div class="footer">
        <p>抽奖系统 &copy; 越秀星月队：每人只能中奖一次，祝愿大家都中大奖！</p>
    </div>

    <script>
        // 所有参与者名单
        const allParticipants = [
            "青苹果", "静静均速勉强20", "思南", "小k", "启超", "彭于晏（均速15）", 
            "👁 曾除取半👀", "天宇", "在野·🌵", "子鱼（企初财税）", "陈杰", "LiaoKang", 
            "浑圆天成 （山地也要冲！", "王冠杰 俺也一样", "Min", "Ou 1", "无恙", "海苔", 
            "仲冬", "左手", "徐小乐（🙊）", "瑞瑞", "法。。。。。克", "碧玉的主人", 
            "明天是晴天", "大熊", "ej", "修阙", "剑心", "一壶老酒", "u", "张浩", "汪大超", "帅徐芸"
        ];

        // 特殊人员
        const specialParticipants = {
            noConsolation: ["仲冬", "碧玉的主人"], // 不参与安慰奖
            noConsolationThird: ["碧玉的主人"], // 不参与安慰奖和三等奖
            noConsolationThirdFirst: ["碧玉的主人"], // 不参与安慰奖、三等奖和一等奖
            firstPrizeCandidates: ["左手", "徐小乐（🙊）", "碧玉的主人", "Ou 1", "法。。。。。克"] // 一等奖候选人
        };

        // 奖项配置
        const prizeConfig = {
            first: { count: 1, name: "一等奖", prize: "头盔", emoji: "🥇" },
            second: { count: 2, name: "二等奖", prize: "前灯", emoji: "🥈" },
            third: { count: 3, name: "三等奖", prize: "眼镜", emoji: "🥉" },
            consolation: { count: 10, name: "安慰奖", prize: "水壶", emoji: "🎁" }
        };

        // 中奖者记录
        const winners = {
            first: [],
            second: [],
            third: [],
            consolation: []
        };

        // 抽奖状态
        let isDrawing = false;
        let currentDrawing = null;
        let drawInterval = null;

        // 开始抽奖
        function startDrawing(prizeType) {
            const button = event.target.closest('.prize-btn');
            
            // 如果正在抽奖，则停止抽奖
            if (isDrawing && currentDrawing === prizeType) {
                stopDrawing(prizeType);
                return;
            }
            
            // 如果已经在抽其他奖项，先停止
            if (isDrawing) {
                stopDrawing(currentDrawing);
                const prevButton = document.querySelector(`.prize-btn.${currentDrawing}-prize`);
                if (prevButton) {
                    // 恢复按钮文本
                    const countSpan = prevButton.querySelector('.prize-count');
                    prevButton.innerHTML = `
                        <div class="prize-info">
                            <span class="prize-icon">${prizeConfig[currentDrawing].emoji}</span>
                            <div class="prize-text">
                                <span class="prize-name">${prizeConfig[currentDrawing].name}</span>
                                <span class="prize-item">${prizeConfig[currentDrawing].prize}</span>
                            </div>
                        </div>
                        ${countSpan.outerHTML}
                    `;
                    prevButton.onclick = function() { startDrawing(currentDrawing); };
                }
            }
            
            // 检查是否还有抽奖次数
            if (winners[prizeType].length >= prizeConfig[prizeType].count) {
                alert(`【${prizeConfig[prizeType].name}】抽奖次数已用完！`);
                button.disabled = true;
                return;
            }
            
            // 开始新的抽奖
            isDrawing = true;
            currentDrawing = prizeType;
            
            // 更新按钮文本
            button.innerHTML = `
                <div class="prize-info">
                    <span class="prize-icon">${prizeConfig[prizeType].emoji}</span>
                    <div class="prize-text">
                        <span class="prize-name">点击停止</span>
                        <span class="prize-item">${prizeConfig[prizeType].prize}</span>
                    </div>
                </div>
                <span class="prize-count">剩余: <span id="${prizeType}-count">${prizeConfig[prizeType].count - winners[prizeType].length}</span></span>
            `;
            button.onclick = function() { startDrawing(prizeType); };
            
            // 获取符合条件的参与者
            let candidates = getCandidates(prizeType);
            
            if (candidates.length === 0) {
                alert("没有符合条件的参与者了！");
                isDrawing = false;
                return;
            }
            
            // 开始滚动效果
            const resultText = document.getElementById("resultText");
            const prizeDesc = document.getElementById("prizeDesc");
            resultText.classList.add("rolling");
            prizeDesc.textContent = `抽取${prizeConfig[prizeType].name}（${prizeConfig[prizeType].prize}）`;
            
            drawInterval = setInterval(() => {
                const randomIndex = Math.floor(Math.random() * candidates.length);
                resultText.textContent = candidates[randomIndex];
            }, 100);
        }

        // 停止抽奖
        function stopDrawing(prizeType) {
            clearInterval(drawInterval);
            isDrawing = false;
            
            const resultText = document.getElementById("resultText");
            const prizeDesc = document.getElementById("prizeDesc");
            resultText.classList.remove("rolling");
            
            // 获取符合条件的参与者
            let candidates = getCandidates(prizeType);
            
            if (candidates.length === 0) {
                resultText.textContent = "没有符合条件的参与者";
                prizeDesc.textContent = "";
                return;
            }
            
            // 随机选择中奖者
            let winner;
            let attempts = 0;
            do {
                const randomIndex = Math.floor(Math.random() * candidates.length);
                winner = candidates[randomIndex];
                attempts++;
                
                // 防止无限循环
                if (attempts > 100) {
                    winner = "抽奖失败，请重试";
                    break;
                }
            } while (winners[prizeType].includes(winner));
            
            if (winner !== "抽奖失败，请重试") {
                // 记录中奖者
                winners[prizeType].push(winner);
                resultText.innerHTML = `<span style="color: #ffce54;">${winner}</span>`;
                prizeDesc.textContent = `恭喜获得${prizeConfig[prizeType].name}（${prizeConfig[prizeType].prize}）！`;
                
                // 更新剩余次数显示
                document.getElementById(`${prizeType}-count`).textContent = prizeConfig[prizeType].count - winners[prizeType].length;
                
                // 更新中奖名单显示
                updateWinnersDisplay();
                
                // 检查抽奖次数是否用完
                if (winners[prizeType].length >= prizeConfig[prizeType].count) {
                    const button = document.querySelector(`.prize-btn.${prizeType}-prize`);
                    button.disabled = true;
                    button.querySelector('.prize-text .prize-name').textContent = "已抽完";
                }
            } else {
                resultText.textContent = winner;
                prizeDesc.textContent = "";
            }
        }

        // 获取符合条件的参与者
        function getCandidates(prizeType) {
            // 过滤掉已经中奖的人
            let candidates = allParticipants.filter(participant => {
                return !Object.values(winners).flat().includes(participant);
            });
            
            // 根据奖项类型应用特殊规则
            if (prizeType === 'consolation') {
                candidates = candidates.filter(participant => 
                    !specialParticipants.noConsolation.includes(participant)
                );
            } else if (prizeType === 'third') {
                candidates = candidates.filter(participant => 
                    !specialParticipants.noConsolationThird.includes(participant)
                );
                
                // 确保仲冬在三等奖候选中
                if (!winners.third.includes("仲冬") && candidates.includes("仲冬")) {
                    return ["仲冬"]; // 直接返回仲冬
                }
            } else if (prizeType === 'first') {
                candidates = candidates.filter(participant => 
                    !specialParticipants.noConsolationThirdFirst.includes(participant)
                );
                
                // 一等奖只能从特定候选人中抽取
                candidates = candidates.filter(participant => 
                    specialParticipants.firstPrizeCandidates.includes(participant)
                );
            }
            
            return candidates;
        }

        // 更新中奖名单显示
        function updateWinnersDisplay() {
            for (const prizeType in winners) {
                const container = document.getElementById(`${prizeType}PrizeWinners`);
                container.innerHTML = '';
                
                winners[prizeType].forEach(winner => {
                    const winnerTag = document.createElement('div');
                    winnerTag.className = 'winner-tag';
                    winnerTag.innerHTML = `<span class="winner-icon">${prizeConfig[prizeType].emoji}</span> ${winner}`;
                    container.appendChild(winnerTag);
                });
            }
        }

        // 初始化显示
        updateWinnersDisplay();
    </script>
</body>
</html>
