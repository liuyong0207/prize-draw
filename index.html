<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¹¸è¿æŠ½å¥–ç³»ç»Ÿ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Microsoft YaHei', sans-serif;
        }
        body {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        .container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            max-width: 1200px;
            width: 100%;
        }
        .lottery-section {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            width: 100%;
            text-align: center;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }
        .participants-box {
            height: 300px;
            overflow: hidden;
            position: relative;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            margin: 20px 0;
            background: rgba(0, 0, 0, 0.2);
        }
        .participants-list {
            position: absolute;
            width: 100%;
            transition: top 0.1s ease;
        }
        .participant {
            padding: 15px;
            font-size: 1.2rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        .highlight {
            background: rgba(255, 215, 0, 0.3);
            font-weight: bold;
        }
        .prize-buttons {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }
        .prize-btn {
            padding: 15px 25px;
            font-size: 1.1rem;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            background: linear-gradient(45deg, #FF5722, #FF9800);
            color: white;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        .prize-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }
        .prize-btn:disabled {
            background: linear-gradient(45deg, #9e9e9e, #607d8b);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        .first-prize {
            background: linear-gradient(45deg, #FF416C, #FF4B2B);
        }
        .second-prize {
            background: linear-gradient(45deg, #4A00E0, #8E2DE2);
        }
        .third-prize {
            background: linear-gradient(45deg, #0072FF, #00C6FF);
        }
        .consolation-prize {
            background: linear-gradient(45deg, #00b09b, #96c93d);
        }
        .results-section {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            width: 100%;
            margin-top: 20px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }
        .results-section h2 {
            text-align: center;
            margin-bottom: 20px;
        }
        .prize-results {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
        }
        .prize-result {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 10px;
            padding: 15px;
            width: 200px;
            text-align: center;
        }
        .prize-result h3 {
            margin-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            padding-bottom: 5px;
        }
        .prize-image {
            width: 100px;
            height: 100px;
            margin: 10px auto;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
        }
        .winner-name {
            font-size: 1.2rem;
            font-weight: bold;
            color: #FFD700;
            margin-top: 10px;
        }
        .instructions {
            margin-top: 30px;
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            max-width: 800px;
        }
        .instructions h2 {
            margin-bottom: 15px;
            text-align: center;
        }
        .instructions ul {
            list-style-position: inside;
            line-height: 1.6;
        }
        .instructions li {
            margin-bottom: 10px;
        }
        @media (max-width: 768px) {
            .prize-buttons {
                flex-direction: column;
            }
            .prize-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>å¹¸è¿æŠ½å¥–ç³»ç»Ÿ</h1>
        <p>ç¥å¤§å®¶å¥½è¿ï¼æ¯äººåªèƒ½ä¸­å¥–ä¸€æ¬¡ï¼ˆå®‰æ…°å¥–é™¤å¤–ï¼‰</p>
    </div>

    <div class="container">
        <div class="lottery-section">
            <h2>æŠ½å¥–åŒº</h2>
            <div class="participants-box">
                <div class="participants-list" id="participantsList">
                    <!-- å‚ä¸è€…åˆ—è¡¨å°†ç”±JSç”Ÿæˆ -->
                </div>
            </div>
            <div class="prize-buttons">
                <button class="prize-btn first-prize" id="firstPrizeBtn">ä¸€ç­‰å¥–ï¼ˆç è¡¨ï¼‰</button>
                <button class="prize-btn second-prize" id="secondPrizeBtn">äºŒç­‰å¥–ï¼ˆå¤´ç›”ï¼‰</button>
                <button class="prize-btn third-prize" id="thirdPrizeBtn">ä¸‰ç­‰å¥–ï¼ˆæ‰‹å¥—ï¼‰</button>
                <button class="prize-btn consolation-prize" id="consolationPrizeBtn">å®‰æ…°å¥–</button>
            </div>
        </div>

        <div class="results-section">
            <h2>ä¸­å¥–ç»“æœ</h2>
            <div class="prize-results">
                <div class="prize-result">
                    <h3>ä¸€ç­‰å¥–ï¼ˆç è¡¨ï¼‰</h3>
                    <div class="prize-image">ç è¡¨å›¾ç‰‡</div>
                    <div class="winner-name" id="firstPrizeWinner">å°šæœªæŠ½å–</div>
                </div>
                <div class="prize-result">
                    <h3>äºŒç­‰å¥–ï¼ˆå¤´ç›”ï¼‰</h3>
                    <div class="prize-image">å¤´ç›”å›¾ç‰‡</div>
                    <div class="winner-name" id="secondPrizeWinner">å°šæœªæŠ½å–</div>
                </div>
                <div class="prize-result">
                    <h3>ä¸‰ç­‰å¥–ï¼ˆæ‰‹å¥—ï¼‰</h3>
                    <div class="prize-image">æ‰‹å¥—å›¾ç‰‡</div>
                    <div class="winner-name" id="thirdPrizeWinner">å°šæœªæŠ½å–</div>
                </div>
                <div class="prize-result">
                    <h3>å®‰æ…°å¥–</h3>
                    <div class="prize-image">å…¶ä»–å›¾ç‰‡</div>
                    <div class="winner-name" id="consolationPrizeWinner">å°šæœªæŠ½å–</div>
                </div>
            </div>
        </div>
    </div>

    <div class="instructions">
        <h2>æŠ½å¥–è§„åˆ™è¯´æ˜</h2>
        <ul>
            <li>ä¸€ç­‰å¥–ã€äºŒç­‰å¥–ã€ä¸‰ç­‰å¥–æ¯ä¸ªåªèƒ½æŠ½å–ä¸€æ¬¡ï¼Œå®‰æ…°å¥–å¯ä»¥å¤šæ¬¡æŠ½å–</li>
            <li>æ¯äººåªèƒ½ä¸­å¥–ä¸€æ¬¡ï¼ˆå®‰æ…°å¥–é™¤å¤–ï¼‰</li>
            <li>ä¸­å¥–ä¿¡æ¯ä¼šä¿å­˜åœ¨æµè§ˆå™¨ä¸­ï¼Œåˆ·æ–°é¡µé¢ä¸ä¼šä¸¢å¤±</li>
        </ul>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // å‚ä¸è€…åˆ—è¡¨
            const allParticipants = [
                "å·¦æ‰‹", "é’è‹¹æœ", "å¾å°ä¹ï¼ˆğŸ™Šï¼‰", "ç‘ç‘", "æ³•ã€‚ã€‚ã€‚ã€‚ã€‚å…‹", 
                "ç¢§ç‰çš„ä¸»äºº", "æ˜å¤©æ˜¯æ™´å¤©", "å¤§ç†Š", "ej", "ä¿®é˜™", "å°ç‹", 
                "å‰‘å¿ƒ", "ä¸€å£¶è€é…’", "u", "é™é™å‡é€Ÿå‹‰å¼º20", "æ€å—", "å°k", 
                "å¯è¶…", "å½­äºæ™ï¼ˆå‡é€Ÿ15ï¼‰", "ğŸ‘ æ›¾é™¤å–åŠğŸ‘€", "å¤©å®‡", "ou"
            ];

            // ä¸å‚ä¸å®‰æ…°å¥–çš„äººå‘˜
            const noConsolationParticipants = ["å·¦æ‰‹", "ç¢§ç‰çš„ä¸»äºº", "ou", "æ³•ã€‚ã€‚ã€‚ã€‚ã€‚å…‹"];
            
            // æƒé‡åŠ å¤§çš„äººå‘˜ï¼ˆäºŒã€ä¸‰ç­‰å¥–ï¼‰
            const highWeightParticipants = ["å·¦æ‰‹", "ç¢§ç‰çš„ä¸»äºº", "ou", "æ³•ã€‚ã€‚ã€‚ã€‚ã€‚å…‹"];

            // åˆå§‹åŒ–ä¸­å¥–è€…
            let winners = {
                firstPrize: null,
                secondPrize: null,
                thirdPrize: null,
                consolationPrize: []
            };

            // ä»localStorageåŠ è½½å·²ä¿å­˜çš„ä¸­å¥–ä¿¡æ¯
            const savedWinners = localStorage.getItem('lotteryWinners');
            if (savedWinners) {
                const parsedWinners = JSON.parse(savedWinners);
                winners = {...winners, ...parsedWinners};
                
                // æ›´æ–°UIæ˜¾ç¤º
                if (winners.firstPrize) {
                    document.getElementById('firstPrizeWinner').textContent = winners.firstPrize;
                    document.getElementById('firstPrizeBtn').disabled = true;
                }
                if (winners.secondPrize) {
                    document.getElementById('secondPrizeWinner').textContent = winners.secondPrize;
                    document.getElementById('secondPrizeBtn').disabled = true;
                }
                if (winners.thirdPrize) {
                    document.getElementById('thirdPrizeWinner').textContent = winners.thirdPrize;
                    document.getElementById('thirdPrizeBtn').disabled = true;
                }
                if (winners.consolationPrize.length > 0) {
                    document.getElementById('consolationPrizeWinner').textContent = 
                        winners.consolationPrize.join(', ');
                }
            }

            // åˆå§‹åŒ–å‚ä¸è€…åˆ—è¡¨
            const participantsList = document.getElementById('participantsList');
            allParticipants.forEach(participant => {
                const div = document.createElement('div');
                div.className = 'participant';
                div.textContent = participant;
                participantsList.appendChild(div);
            });

            const participants = document.querySelectorAll('.participant');
            let scrollInterval = null;
            let isScrolling = false;
            let currentPrizeType = '';

            // å¼€å§‹æ»šåŠ¨å‡½æ•°
            function startScrolling(prizeType) {
                currentPrizeType = prizeType;
                isScrolling = true;
                
                // æ¸…é™¤æ‰€æœ‰é«˜äº®
                participants.forEach(p => p.classList.remove('highlight'));
                
                // è®¾ç½®æ»šåŠ¨é€Ÿåº¦
                const speed = prizeType === 'consolation' ? 80 : 100;
                
                scrollInterval = setInterval(() => {
                    const randomIndex = Math.floor(Math.random() * participants.length);
                    participants.forEach(p => p.classList.remove('highlight'));
                    participants[randomIndex].classList.add('highlight');
                    
                    // æ»šåŠ¨åˆ—è¡¨
                    const list = document.getElementById('participantsList');
                    const highlighted = document.querySelector('.highlight');
                    if (highlighted) {
                        const topPos = highlighted.offsetTop;
                        list.style.top = -topPos + 150 + 'px';
                    }
                }, speed);
            }

            // åœæ­¢æ»šåŠ¨å¹¶é€‰æ‹©è·å¥–è€…
            function stopScrolling() {
                clearInterval(scrollInterval);
                isScrolling = false;
                
                let availableParticipants = [];
                
                if (currentPrizeType === 'first') {
                    // ä¸€ç­‰å¥–ç›´æ¥æŒ‡å®šä¸ºå¾å°ä¹
                    const winner = "å¾å°ä¹ï¼ˆğŸ™Šï¼‰";
                    winners.firstPrize = winner;
                    document.getElementById('firstPrizeWinner').textContent = winner;
                    document.getElementById('firstPrizeBtn').disabled = true;
                    highlightWinner(winner);
                } else if (currentPrizeType === 'second' || currentPrizeType === 'third') {
                    // äºŒã€ä¸‰ç­‰å¥–ï¼Œæƒé‡åŠ å¤§
                    availableParticipants = allParticipants.filter(p => 
                        !isAlreadyWinner(p) && 
                        (currentPrizeType === 'second' ? !winners.secondPrize : !winners.thirdPrize)
                    );
                    
                    // å¢åŠ æƒé‡
                    let weightedParticipants = [];
                    availableParticipants.forEach(p => {
                        if (highWeightParticipants.includes(p)) {
                            // æƒé‡åŠ å¤§çš„äººå‘˜æ·»åŠ 3æ¬¡
                            weightedParticipants.push(p, p, p);
                        } else {
                            weightedParticipants.push(p);
                        }
                    });
                    
                    const randomIndex = Math.floor(Math.random() * weightedParticipants.length);
                    const winner = weightedParticipants[randomIndex];
                    
                    if (currentPrizeType === 'second') {
                        winners.secondPrize = winner;
                        document.getElementById('secondPrizeWinner').textContent = winner;
                        document.getElementById('secondPrizeBtn').disabled = true;
                    } else {
                        winners.thirdPrize = winner;
                        document.getElementById('thirdPrizeWinner').textContent = winner;
                        document.getElementById('thirdPrizeBtn').disabled = true;
                    }
                    
                    highlightWinner(winner);
                } else if (currentPrizeType === 'consolation') {
                    // å®‰æ…°å¥–ï¼Œæ’é™¤ä¸å‚ä¸çš„äººå‘˜å’Œå·²ä¸­å¥–äººå‘˜
                    availableParticipants = allParticipants.filter(p => 
                        !noConsolationParticipants.includes(p) && 
                        !isAlreadyWinner(p)
                    );
                    
                    if (availableParticipants.length > 0) {
                        const randomIndex = Math.floor(Math.random() * availableParticipants.length);
                        const winner = availableParticipants[randomIndex];
                        winners.consolationPrize.push(winner);
                        document.getElementById('consolationPrizeWinner').textContent = 
                            winners.consolationPrize.join(', ');
                        highlightWinner(winner);
                    } else {
                        alert('æ²¡æœ‰å¯å‚ä¸å®‰æ…°å¥–æŠ½å¥–çš„äººå‘˜äº†ï¼');
                    }
                }
                
                // ä¿å­˜åˆ°localStorage
                localStorage.setItem('lotteryWinners', JSON.stringify(winners));
            }

            // æ£€æŸ¥æ˜¯å¦å·²ç»æ˜¯è·å¥–è€…
            function isAlreadyWinner(participant) {
                return winners.firstPrize === participant || 
                       winners.secondPrize === participant || 
                       winners.thirdPrize === participant || 
                       winners.consolationPrize.includes(participant);
            }

            // é«˜äº®æ˜¾ç¤ºè·å¥–è€…
            function highlightWinner(winner) {
                participants.forEach(p => {
                    p.classList.remove('highlight');
                    if (p.textContent === winner) {
                        p.classList.add('highlight');
                        
                        // æ»šåŠ¨åˆ°è·å¥–è€…ä½ç½®
                        const list = document.getElementById('participantsList');
                        const topPos = p.offsetTop;
                        list.style.top = -topPos + 150 + 'px';
                    }
                });
            }

            // æŒ‰é’®äº‹ä»¶ç›‘å¬
            document.getElementById('firstPrizeBtn').addEventListener('click', function() {
                if (isScrolling && currentPrizeType === 'first') {
                    stopScrolling();
                } else if (!winners.firstPrize) {
                    startScrolling('first');
                }
            });

            document.getElementById('secondPrizeBtn').addEventListener('click', function() {
                if (isScrolling && currentPrizeType === 'second') {
                    stopScrolling();
                } else if (!winners.secondPrize) {
                    startScrolling('second');
                }
            });

            document.getElementById('thirdPrizeBtn').addEventListener('click', function() {
                if (isScrolling && currentPrizeType === 'third') {
                    stopScrolling();
                } else if (!winners.thirdPrize) {
                    startScrolling('third');
                }
            });

            document.getElementById('consolationPrizeBtn').addEventListener('click', function() {
                if (isScrolling && currentPrizeType === 'consolation') {
                    stopScrolling();
                } else {
                    startScrolling('consolation');
                }
            });
        });
    </script>
</body>
</html>
